{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","index.js","lib/character_sheet_panel.js","lib/login_panel.js","lib/panel.js","lib/prompt_panel.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"client.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","'use strict';\r\n\r\nconst LoginPanel = require('./lib/login_panel.js');\r\nconst PromptPanel = require('./lib/prompt_panel.js');\r\nconst CharacterSheetPanel = require('./lib/character_sheet_panel.js');\r\n\r\nclass Client {\r\n\tconstructor() {\r\n\t\tlet wsurl = \"ws\" + window.location.href.substring(4); // replaces the \"http\" with \"ws\" (and also does \"https\" -> \"wss\" as well)\r\n\t\tthis.socket = new WebSocket(wsurl); // open a connection\r\n\t\tthis.socket.addEventListener('message', this.handle_message.bind(this));\r\n\r\n\t\tthis.chat_window = document.getElementById(\"chatwindow\");\r\n\t\tdocument.getElementById(\"main-text-input\").addEventListener(\"keydown\", this.text_input_keydown.bind(this));\r\n\t\tdocument.body.addEventListener(\"click\", this.handle_click.bind(this));\r\n\t\tdocument.body.addEventListener(\"change\", this.handle_change.bind(this));\r\n\t\tthis.player_names = {\"-1\": \"GM\"};\r\n\r\n\t\tthis.character_sheet = {};\r\n\t\tthis.character_sheets = {}; // GM only - the one above is the player's char sheet and this one and the one below are the GM's char sheets.\r\n\t\tthis.char_sheet_panels = {};\r\n\t}\r\n\r\n\thandle_message(e) {\r\n\t\tlet obj = JSON.parse(e.data);\r\n\t\tconsole.log(obj);\r\n\t\tif(obj.show_login_panel) {\r\n\t\t\tnew LoginPanel(this);\r\n\t\t}\r\n\t\tif(obj.be_gm) {\r\n\t\t\tdocument.body.classList.add(\"is-gm\"); // basically you can stick various classes on elements to make them only visible if youre a gm.\r\n\t\t}\r\n\t\tif(obj.frozen != null) { // only gm gets this.\r\n\t\t\tdocument.getElementById(\"frozen-checkbox\").checked = obj.frozen;\r\n\t\t}\r\n\t\tif(obj.add_player) {\r\n\t\t\tlet po = obj.add_player;\r\n\t\t\tthis.player_names[po.id] = po.name;\r\n\t\t\tlet elem = document.createElement(\"div\");\r\n\t\t\telem.classList.add(\"player-entry\");\r\n\t\t\telem.dataset.playernum = po.id;\r\n\t\t\telem.innerHTML = `\r\n<div style='text-align:center;${po.name_style}' class='player-name ${po.name_class}'></div>\r\n<div class='gm-only' style='font-size:12px;font-style:italic;text-align:center'>Player</div>\r\n<div>\r\n\t<input type='button' class='pm-button' value='PM'>\r\n\t<input type='button' class='edit-char-button gm-only' value='Edit Character Sheet'>\r\n\t<input type='button' class='spoof-button gm-only' value='Spoof'>\r\n\t<label class='gm-only'><input type='checkbox' class='mute-checkbox'>Mute</label>\r\n</div>\r\n`;\r\n\t\t\telem.querySelector('.player-name').textContent = po.name;\r\n\t\t\tdocument.getElementById(\"playerslist\").appendChild(elem);\r\n\t\t}\r\n\t\tif(obj.add_npc) {\r\n\t\t\tlet po = obj.add_npc;\r\n\t\t\tthis.player_names[po.id] = po.name;\r\n\t\t\tlet elem = document.createElement(\"div\");\r\n\t\t\telem.classList.add(\"player-entry\");\r\n\t\t\telem.dataset.playernum = po.id;\r\n\t\t\telem.innerHTML = `\r\n<div style='text-align:center;${po.name_style}' class='player-name ${po.name_class}'></div>\r\n<div style='font-size:12px;font-style:italic;text-align:center'>NPC</div>\r\n<div>\r\n\t<input type='button' class='spoof-button gm-only' value='Spoof'>\r\n</div>\r\n`;\r\n\t\t\telem.querySelector('.player-name').textContent = po.name;\r\n\t\t\tdocument.getElementById(\"npcslist\").appendChild(elem);\r\n\t\t}\r\n\t\tif(obj.to_chat) {\r\n\t\t\tlet items = obj.to_chat;\r\n\t\t\tif(!(items instanceof Array))\r\n\t\t\t\titems = [items];\r\n\t\t\tthis.modify_chat(() => {\r\n\t\t\t\tfor(let item of items) {\r\n\t\t\t\t\t// wrap them in divs and toss them at the end of the chat window`\r\n\t\t\t\t\tlet newdiv = document.createElement('div');\r\n\t\t\t\t\tnewdiv.innerHTML = item;\r\n\t\t\t\t\tthis.chat_window.appendChild(newdiv);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tif(obj.playernum) {\r\n\t\t\t// sets our playernum so we can retrieve our name\r\n\t\t\tthis.playernum = obj.playernum;\r\n\t\t}\r\n\t\tif(obj.character_sheet) {\r\n\t\t\tthis.character_sheet = obj.character_sheet;\r\n\t\t\tif(this.character_sheet_panel)\r\n\t\t\t\tthis.character_sheet_panel.update_data(this.character_sheet);\r\n\t\t}\r\n\t\tif(obj.character_sheets) {\r\n\t\t\tObject.assign(this.character_sheets, obj.character_sheets);\r\n\t\t\t// no need to update anything, there's no panels open since this is only sent on login\r\n\t\t\t// and only the GM can change the character sheets.\r\n\t\t}\r\n\t}\r\n\r\n\thandle_click(e) {\r\n\t\tlet input = e.target.closest(\"input\");\r\n\t\tlet playernum_elem = e.target.closest(\"[data-playernum]\");\r\n\t\tlet playernum = playernum_elem ? playernum_elem.dataset.playernum : null;\r\n\t\tif(input) {\r\n\t\t\tif(input.dataset.dice) {\r\n\t\t\t\tlet maxval = +input.dataset.dice;\r\n\t\t\t\tdocument.getElementById(\"dice-output\").value = Math.floor(Math.random()*maxval) + 1;\r\n\t\t\t}\r\n\t\t\tif(input.classList.contains(\"pm-button\") && playernum) {\r\n\t\t\t\tnew PromptPanel(`PM to ${this.player_names[playernum]}`).value_promise().then((val) => {\r\n\t\t\t\t\tif(!val)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tthis.socket.send(JSON.stringify({pm: {to: playernum, text: val}}));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif(input.classList.contains(\"spoof-button\") && playernum) {\r\n\t\t\t\tnew PromptPanel(`Spoofing ${this.player_names[playernum]}`).value_promise().then((val) => {\r\n\t\t\t\t\tif(!val)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tthis.socket.send(JSON.stringify({spoof: {victim: playernum, text: val}}));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif(input.classList.contains(\"char-sheet-button\") && !this.char_sheet_panel) {\r\n\t\t\t\tthis.char_sheet_panel = new CharacterSheetPanel(this, false);\r\n\t\t\t\tthis.char_sheet_panel.update_data(this.character_sheet);\r\n\t\t\t\tthis.char_sheet_panel.update_name(this.player_names[this.playernum]);\r\n\t\t\t\tthis.char_sheet_panel.wait_until_close().then(() => {\r\n\t\t\t\t\tthis.char_sheet_panel = null;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif(input.classList.contains(\"edit-char-button\") && playernum && !this.char_sheet_panels[playernum]) {\r\n\t\t\t\tthis.char_sheet_panels[playernum] = new CharacterSheetPanel(this, true, playernum);\r\n\t\t\t\tthis.char_sheet_panels[playernum].update_data(this.character_sheets[playernum]);\r\n\t\t\t\tthis.char_sheet_panels[playernum].update_name(this.player_names[playernum]);\r\n\t\t\t\tthis.char_sheet_panels[playernum].wait_until_close().then(() => {\r\n\t\t\t\t\tthis.char_sheet_panels[playernum] = null;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet pm_link = e.target.closest(\"[data-pm]\");\r\n\t\tif(pm_link) {\r\n\t\t\tnew PromptPanel(`PM reply`).value_promise().then((val) => {\r\n\t\t\t\tif(!val)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tthis.socket.send(JSON.stringify({pm: {to: pm_link.dataset.pm, text: val}}));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandle_change(e) {\r\n\t\tlet input = e.target.closest(\"input\");\r\n\t\tlet playernum_elem = e.target.closest(\"[data-playernum]\");\r\n\t\tlet playernum = playernum_elem ? playernum_elem.dataset.playernum : null;\r\n\t\tif(input) {\r\n\t\t\tif(input.id == \"frozen-checkbox\") {\r\n\t\t\t\tthis.socket.send(JSON.stringify({frozen: !!input.checked}));\r\n\t\t\t}\r\n\t\t\tif(input.classList.contains(\"mute-checkbox\") && playernum) {\r\n\t\t\t\tif(input.checked)\r\n\t\t\t\t\tthis.socket.send(JSON.stringify({mute_player: playernum}));\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.socket.send(JSON.stringify({unmute_player: playernum}));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttext_input_keydown(e) {\r\n\t\tlet text_input = document.getElementById(\"main-text-input\");\r\n\t\tif(e.which == 13) { // enter\r\n\t\t\tlet text = text_input.value;\r\n\t\t\ttext_input.value = \"\";\r\n\t\t\tthis.socket.send(JSON.stringify({chat: text}));\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t}\r\n\r\n\tmodify_chat(callback) { // wrap your chat modifications with this function so that the scroll gets updated properly\r\n\t\tlet do_scroll = false;\r\n\t\tif(Math.ceil(this.chat_window.scrollTop + this.chat_window.clientHeight) >= Math.floor(this.chat_window.scrollHeight)) // check if the thing is scrolled all the way down\r\n\t\t\tdo_scroll = true; // makes it keep itself scrolled down\r\n\t\tcallback(); // now the chat window gets modified\r\n\t\t// and now we scroll all the way down if it was that way before\r\n\t\tif(do_scroll)\r\n\t\t\tthis.chat_window.scrollTop = this.chat_window.scrollHeight - this.chat_window.clientHeight;\r\n\t}\r\n}\r\n\r\nwindow.addEventListener(\"DOMContentLoaded\", () => {\r\n\t// alrighty let's connect\r\n\twindow.client = new Client();\r\n});\r\n","'use strict';\r\nconst Panel = require('./panel.js');\r\n\r\nclass CharacterSheetPanel extends Panel {\r\n\tconstructor(client, edit_mode = true, playernum) {\r\n\t\tsuper({width: 540, height: 600, title:\"Character Sheet\"});\r\n\t\tthis.client = client;\r\n\t\tthis.playernum = playernum;\r\n\t\tthis.content_obj.innerHTML =`\r\n<div><input type='button' class='save-button' value = \"Save and Send Sheet\"></div>\r\n<h1 class=\"charname\">Gen-R-ICC-1</h1>\r\n<div class='left-part'>\r\n\t<div class='margins'><b>Service Group: </b><span data-csfield=\"service_group\"></span></div>\r\n\t<div class='margins'><b>Firm: </b><span data-csfield=\"firm\"></span></div>\r\n\t<div class='margins'><b>Gender: </b><span data-csfield=\"gender\"></span></div>\r\n\t<div class='margins'><b>Tics: </b><span data-csfield=\"tics\" class='fullwidth'></span></div>\r\n\t<table class='margins'>\r\n\t\t<tr>\r\n\t\t\t<td><b>MBD: </b></td>\r\n\t\t\t<td><label><input type='checkbox' data-csfield=\"mbd1\">Team Leader</label></td>\r\n\t\t\t<td><label><input type='checkbox' data-csfield=\"mbd3\">Loyalty Officer</label></td>\r\n\t\t\t<td><label><input type='checkbox' data-csfield=\"mbd5\">Hygiene Officer</label></td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td></td>\r\n\t\t\t<td><label><input type='checkbox' data-csfield=\"mbd2\">C&RO</label></td>\r\n\t\t\t<td><label><input type='checkbox' data-csfield=\"mbd4\">Equipment Guy</label></td>\r\n\t\t\t<td><label><input type='checkbox' data-csfield=\"mbd6\">Happiness Officer</label></td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td></td>\r\n\t\t\t<td colspan=3><input type='checkbox' data-csfield=\"mbd_custom\"><span data-csfield=\"mbd_custom_name\"></span></td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n`;\r\n\t\tfor(let elem of this.$$('[data-csfield]')) {\r\n\t\t\tif(elem.tagName == \"INPUT\") {\r\n\t\t\t\tif(elem.type == \"checkbox\") {\r\n\t\t\t\t\tif(!edit_mode)\r\n\t\t\t\t\t\telem.addEventListener(\"click\", (e)=>{e.preventDefault(); return false;}); // prevent click events. The checkbox is nearly unreadable if it's grey, so doing this instead\r\n\t\t\t\t} else {\r\n\t\t\t\t\telem.readonly = !edit_mode;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\telem.contentEditable = edit_mode;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(edit_mode) {\r\n\t\t\tthis.$('.save-button').addEventListener(\"click\", () => {\r\n\t\t\t\tlet data = this.get_data();\r\n\t\t\t\tclient.socket.send(JSON.stringify({update_character_sheet: {for: this.playernum, data}}));\r\n\t\t\t\tthis.client.character_sheets[this.playernum] = data;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.$('.save-button').style.display = \"none\"; // ree get rid of that button\r\n\t\t}\r\n\t}\r\n\r\n\tupdate_name(name) {\r\n\t\tthis.$('.charname').textContent = name;\r\n\t}\r\n\tupdate_data(data) {\r\n\t\tif(!data)\r\n\t\t\treturn; // ooh it's blank.\r\n\t\tfor(let elem of this.$$('[data-csfield]')) {\r\n\t\t\tlet key = elem.dataset.csfield;\r\n\t\t\tif(elem.tagName == \"INPUT\") {\r\n\t\t\t\tif(elem.type == \"checkbox\") { //checkboxes use checked instead of value\r\n\t\t\t\t\telem.checked = data[key];\r\n\t\t\t\t} else {\r\n\t\t\t\t\telem.value = string_wrapper(data[key]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\telem.innerHTML = string_wrapper(data[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget_data() { // literally the same as update_data but the assignments are swapped.\r\n\t\tlet data = {};\r\n\t\tfor(let elem of this.$$('[data-csfield]')) {\r\n\t\t\tlet key = elem.dataset.csfield;\r\n\t\t\tif(elem.tagName == \"INPUT\") {\r\n\t\t\t\tif(elem.type == \"checkbox\") {\r\n\t\t\t\t\tdata[key] = elem.checked;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata[key] = elem.value;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdata[key] = elem.innerHTML;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn data;\r\n\t}\r\n}\r\n\r\nfunction string_wrapper(obj) { // prevents things like \"undefined\" and \"null\" showing up.\r\n\tif(obj == null)\r\n\t\treturn \"\";\r\n\telse\r\n\t\treturn \"\"+obj;\r\n}\r\n\r\nmodule.exports = CharacterSheetPanel;\r\n","'use strict';\r\nconst Panel = require('./panel.js');\r\n\r\nclass LoginPanel extends Panel {\r\n\tconstructor(client) {\r\n\t\tsuper({width: 240, height: 288, title: \"Login\", can_close: false});\r\n\t\tthis.client = client;\r\n\t\tthis.content_obj.innerHTML = `\r\n<form>\r\n<div style='display:inline-block;text-align:left'>\r\n\t<div class='available_players'></div>\r\n\t<label><input type='radio' class='observe-checkbox' name='login-type' value='observe' checked>Observe</label>\r\n</div><br></form>\r\n<input type='password' class='password-field' placeholder=\"Password (default is 'asdf')\" disabled><br>\r\n<div style='color:red' class='login-fail-reason'></div>\r\n<input type='button' class='login-button' value='Login'></input>\r\n`;\r\n\t\tthis.$('.login-button').addEventListener(\"click\", () => {\r\n\t\t\tlet selected_elem = this.$('input:checked');\r\n\t\t\tconsole.log(selected_elem);\r\n\t\t\tif(selected_elem.dataset.playernum) {\r\n\t\t\t\tlet sel_player = +selected_elem.dataset.playernum;\r\n\t\t\t\tlet password = this.$('.password-field').value;\r\n\t\t\t\tconsole.log(\"GO!\");\r\n\t\t\t\tthis.client.socket.send(JSON.stringify({password, sel_player, login: true}));\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.content_obj.addEventListener(\"change\", (e) => { // handle observed changes\r\n\t\t\tconsole.log(e);\r\n\t\t\tthis.$('.password-field').disabled = this.$('.observe-checkbox').checked;\r\n\t\t});\r\n\t\tthis.handle_message = this.handle_message.bind(this);\r\n\t\tthis.client.socket.addEventListener(\"message\", this.handle_message);\r\n\t}\r\n\r\n\thandle_message(e) {\r\n\t\tlet obj = JSON.parse(e.data);\r\n\t\tif(obj.avail_players) {\r\n\t\t\tlet curr_playernum = this.$(`.available_players input[checked]`);\r\n\t\t\tcurr_playernum = curr_playernum && +curr_playernum.dataset.playernum; // get the currently selected player if theres a checked element\r\n\t\t\tthis.$(`.available_players`).innerHTML = \"\"; // clear it.\r\n\t\t\tfor(let [key, val] of Object.entries(obj.avail_players)) {\r\n\t\t\t\tlet label = document.createElement(\"label\");\r\n\t\t\t\tlabel.textContent = val;\r\n\t\t\t\tlabel.style.display = \"block\"; // so that they each are on different lines\r\n\t\t\t\tlet radiobutton = document.createElement(\"input\");\r\n\t\t\t\tradiobutton.type = \"radio\";\r\n\t\t\t\tradiobutton.dataset.playernum = key;\r\n\t\t\t\tradiobutton.name = \"login-type\";\r\n\t\t\t\tlabel.prepend(radiobutton); // add it before the text\r\n\t\t\t\tthis.$(`.available_players`).appendChild(label);\r\n\t\t\t\tif(+key == curr_playernum) {\r\n\t\t\t\t\tradiobutton.checked = true;\r\n\t\t\t\t\tcurr_playernum = null; // mark that we've resolved this and don't need to check the observe.\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(curr_playernum) { // there was a player checked, but it's gone now, so go back to observe\r\n\t\t\t\tthis.$(`.observe-checkbox`).checked = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(obj.login_fail) {\r\n\t\t\tthis.$('.login-fail-reason').textContent = obj.login_fail;\r\n\t\t}\r\n\t\tif(obj.login_success) {\r\n\t\t\tthis.close();\r\n\t\t}\r\n\t}\r\n\r\n\tclose() {\r\n\t\tthis.client.socket.removeEventListener(\"message\", this.handle_message);\r\n\t\tsuper.close(...arguments);\r\n\t}\r\n}\r\n\r\nmodule.exports = LoginPanel;\r\n","'use strict';\r\n\r\nclass Panel {\r\n\tconstructor({width=400, height=400, title=\"\", can_close = true} = {}) {\r\n\t\tvar left = document.documentElement.clientWidth / 2 - width / 2;\r\n\t\tvar top = document.documentElement.clientHeight / 2 - height / 2;\r\n\t\tthis.container_obj = document.createElement('div');\r\n\t\tObject.assign(this.container_obj.style, {width:width+\"px\", height:height+\"px\", left:left+\"px\", top:top+\"px\"});\r\n\t\tthis.container_obj.classList.add('uiframe-container');\r\n\t\tthis.panel_obj = document.createElement('div');\r\n\t\tthis.panel_obj.classList.add('uiframe');\r\n\t\tthis.panel_obj.tabIndex = -1;\r\n\t\tthis.header_obj = document.createElement('div');\r\n\t\tthis.header_obj.classList.add('uiframe-header');\r\n\t\tthis.title_node = document.createTextNode(title);\r\n\t\tthis.header_obj.appendChild(this.title_node);\r\n\t\tthis.content_obj = document.createElement('div');\r\n\t\tthis.content_obj.classList.add('uiframe-content');\r\n\t\tthis.panel_obj.appendChild(this.header_obj);\r\n\t\tthis.panel_obj.appendChild(this.content_obj);\r\n\t\tthis.container_obj.appendChild(this.panel_obj);\r\n\t\tdocument.getElementById('uiframes-container').appendChild(this.container_obj);\r\n\r\n\t\tthis.header_obj.addEventListener(\"mousedown\", this._start_drag.bind(this));\r\n\t\tthis.container_obj.addEventListener(\"mousedown\", this._start_resize.bind(this));\r\n\t\tthis.container_obj.addEventListener(\"mousemove\", this._container_mousemove.bind(this));\r\n\t\tthis.container_obj.addEventListener(\"mouseout\", this._container_mouseout.bind(this));\r\n\r\n\t\tthis.can_close = can_close;\r\n\r\n\t\tif(can_close) {\r\n\t\t\tthis.close_button = document.createElement('div');\r\n\t\t\tthis.close_button.classList.add('uiframe-close-button');\r\n\t\t\tthis.header_obj.appendChild(this.close_button);\r\n\r\n\t\t\tthis.close_button.addEventListener(\"click\", () => {\r\n\t\t\t\tthis.close();\r\n\t\t\t});\r\n\t\t\tthis.close_button.addEventListener(\"mousedown\", (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t_start_drag(e) {\r\n\t\tif(e.defaultPrevented)\r\n\t\t\treturn;\r\n\t\tif(e.target != this.header_obj) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar pad = (this.container_obj.offsetWidth - this.panel_obj.offsetWidth)/2;\r\n\t\te.preventDefault();\r\n\t\tthis.panel_obj.focus();\r\n\t\tvar lastclientx = e.clientX;\r\n\t\tvar lastclienty = e.clientY;\r\n\t\tvar mousemove = (e) => {\r\n\t\t\tvar dx = e.clientX - lastclientx;\r\n\t\t\tvar dy = e.clientY - lastclienty;\r\n\t\t\tlastclientx = e.clientX;\r\n\t\t\tlastclienty = e.clientY;\r\n\t\t\tvar {left:oldleft, top:oldtop} = this.container_obj.getBoundingClientRect();\r\n\t\t\tthis.container_obj.style.left = Math.min(document.documentElement.clientWidth-160-pad, Math.max(-pad,oldleft + dx)) + \"px\";\r\n\t\t\tthis.container_obj.style.top = Math.min(document.documentElement.clientHeight-35-pad, Math.max(-pad,oldtop + dy)) + \"px\";\r\n\t\t};\r\n\t\tvar mouseup = () => {\r\n\t\t\tdocument.removeEventListener(\"mousemove\", mousemove);\r\n\t\t\tdocument.removeEventListener(\"mouseup\", mouseup);\r\n\t\t};\r\n\t\tdocument.addEventListener(\"mousemove\", mousemove);\r\n\t\tdocument.addEventListener(\"mouseup\", mouseup);\r\n\t}\r\n\r\n\t_resize_meta(e) { // figure out which edge the mouse cursor is on and return an object with the appropriate flags\r\n\t\tvar pad = (this.container_obj.offsetWidth - this.panel_obj.offsetWidth)/2;\r\n\t\tvar width = this.panel_obj.offsetWidth;\r\n\t\tvar height = this.panel_obj.offsetHeight;\r\n\t\tvar out = {drag_right: false, drag_left: false, drag_up: false, drag_down: false, cursor: \"default\"};\r\n\t\tif(e.target == this.container_obj) {\r\n\t\t\tif(e.offsetX < pad)\r\n\t\t\t\tout.drag_left = true;\r\n\t\t\tif(e.offsetY < pad)\r\n\t\t\t\tout.drag_up = true;\r\n\t\t\tif(e.offsetX > (width + pad))\r\n\t\t\t\tout.drag_right = true;\r\n\t\t\tif(e.offsetY > (height + pad))\r\n\t\t\t\tout.drag_down = true;\r\n\t\t\tif((out.drag_left && out.drag_down) || (out.drag_up && out.drag_right)) {\r\n\t\t\t\tout.cursor = \"nesw-resize\";\r\n\t\t\t} else if((out.drag_left && out.drag_up) || (out.drag_down && out.drag_right)) {\r\n\t\t\t\tout.cursor = \"nwse-resize\";\r\n\t\t\t} else if(out.drag_left || out.drag_right) {\r\n\t\t\t\tout.cursor = \"ew-resize\";\r\n\t\t\t} else if(out.drag_up || out.drag_down) {\r\n\t\t\t\tout.cursor = \"ns-resize\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tout.can_resize = out.drag_right || out.drag_left || out.drag_up || out.drag_down;\r\n\t\treturn out;\r\n\t}\r\n\r\n\t_start_resize(e) {\r\n\t\t// bring the panel to the front\r\n\t\tif(this.container_obj != document.getElementById('uiframes-container').lastChild)\r\n\t\t\tdocument.getElementById('uiframes-container').appendChild(this.container_obj);\r\n\r\n\t\t// figure out which edges we're resizing\r\n\t\tvar resize_meta = this._resize_meta(e);\r\n\t\tif(!resize_meta.can_resize) // oof we're not resizing\r\n\t\t\treturn;\r\n\t\t// figure out how much space is around the edges\r\n\t\tvar pad = (this.container_obj.offsetWidth - this.panel_obj.offsetWidth)/2;\r\n\t\te.preventDefault();\r\n\t\tthis.panel_obj.focus();\r\n\t\tvar lastclientx = e.clientX;\r\n\t\tvar lastclienty = e.clientY;\r\n\t\t// now start dragging\r\n\t\tvar mousemove = (e) => {\r\n\t\t\tvar dx = e.clientX - lastclientx;\r\n\t\t\tvar dy = e.clientY - lastclienty;\r\n\t\t\tlastclientx = e.clientX;\r\n\t\t\tlastclienty = e.clientY; // figure out how much we moved\r\n\t\t\tvar {left:oldleft, top:oldtop} = this.container_obj.getBoundingClientRect();\r\n\t\t\tif(resize_meta.drag_left) { // and now resize ourselves\r\n\t\t\t\tthis.container_obj.style.left = Math.min(document.documentElement.clientWidth-160-pad,Math.max(-pad,oldleft + dx)) + \"px\";\r\n\t\t\t\tthis.container_obj.style.width = Math.max(160,this.panel_obj.clientWidth - dx) + \"px\";\r\n\t\t\t} else if(resize_meta.drag_right) {\r\n\t\t\t\tthis.container_obj.style.width = Math.max(160,this.panel_obj.clientWidth + dx) + \"px\";\r\n\t\t\t}\r\n\t\t\tif(resize_meta.drag_up) {\r\n\t\t\t\tthis.container_obj.style.top = Math.min(document.documentElement.clientHeight-35-pad,Math.max(-pad,oldtop + dy)) + \"px\";\r\n\t\t\t\tthis.container_obj.style.height = Math.max(35,this.panel_obj.clientHeight - dy) + \"px\";\r\n\t\t\t} else if(resize_meta.drag_down) {\r\n\t\t\t\tthis.container_obj.style.height = Math.max(35,this.panel_obj.clientHeight + dy) + \"px\";\r\n\t\t\t}\r\n\t\t};\r\n\t\tvar mouseup = () => {\r\n\t\t\tdocument.removeEventListener(\"mousemove\", mousemove);\r\n\t\t\tdocument.removeEventListener(\"mouseup\", mouseup);\r\n\t\t};\r\n\t\tdocument.addEventListener(\"mousemove\", mousemove);\r\n\t\tdocument.addEventListener(\"mouseup\", mouseup);\r\n\t}\r\n\r\n\t_container_mousemove(e) {\r\n\t\tvar resize_meta = this._resize_meta(e);\r\n\t\tthis.container_obj.style.cursor = resize_meta.cursor;\r\n\t}\r\n\t_container_mouseout() {\r\n\t\tthis.container_obj.style.cursor = \"default\";\r\n\t}\r\n\r\n\tget title() {\r\n\t\treturn this.title_node.textContent;\r\n\t}\r\n\r\n\tset title(val) {\r\n\t\tthis.title_node.textContent = val;\r\n\t}\r\n\r\n\tclose() {\r\n\t\tdocument.getElementById('uiframes-container').removeChild(this.container_obj); // remove ourselves!\r\n\t\tif(this.close_promise_resolve)\r\n\t\t\tthis.close_promise_resolve();\r\n\t}\r\n\r\n\twait_until_close() {\r\n\t\tif(this.close_promise)\r\n\t\t\treturn this.close_promise;\r\n\t\treturn this.close_promise = new Promise(resolve => {\r\n\t\t\tthis.close_promise_resolve = resolve;\r\n\t\t});\r\n\t}\r\n\r\n\t// convenience functions\r\n\t$(sel) {\r\n\t\treturn this.content_obj.querySelector(sel);\r\n\t}\r\n\t$$(sel) {\r\n\t\treturn this.content_obj.querySelectorAll(sel);\r\n\t}\r\n}\r\n\r\nmodule.exports = Panel;\r\n","'use strict';\r\nconst Panel = require('./panel.js');\r\n\r\nclass PromptPanel extends Panel {\r\n\tconstructor(title) {\r\n\t\tsuper({width: 400, height: 100, title});\r\n\t\tthis.content_obj.innerHTML = `\r\n<input style='width:90%' type='text' class='prompt-value'></input>\r\n<input type='button' class='confirm-button' value='OK'>\r\n`;\r\n\t\tthis.return_val = null;\r\n\t\tthis.$('.confirm-button').addEventListener(\"click\", () => {\r\n\t\t\tthis.return_val = this.$('.prompt-value').value;\r\n\t\t\tthis.close();\r\n\t\t});\r\n\t\tthis.$('.prompt-value').addEventListener(\"keydown\", (e) => {\r\n\t\t\tif(e.which == 13) { // enter\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.return_val = this.$('.prompt-value').value;\r\n\t\t\t\tthis.close();\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.$('.prompt-value').focus();\r\n\t}\r\n\r\n\tasync value_promise() {\r\n\t\tawait this.wait_until_close();\r\n\t\treturn this.return_val;\r\n\t}\r\n}\r\n\r\nmodule.exports = PromptPanel;\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJpbmRleC5qcyIsImxpYi9jaGFyYWN0ZXJfc2hlZXRfcGFuZWwuanMiLCJsaWIvbG9naW5fcGFuZWwuanMiLCJsaWIvcGFuZWwuanMiLCJsaWIvcHJvbXB0X3BhbmVsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuY29uc3QgTG9naW5QYW5lbCA9IHJlcXVpcmUoJy4vbGliL2xvZ2luX3BhbmVsLmpzJyk7XHJcbmNvbnN0IFByb21wdFBhbmVsID0gcmVxdWlyZSgnLi9saWIvcHJvbXB0X3BhbmVsLmpzJyk7XHJcbmNvbnN0IENoYXJhY3RlclNoZWV0UGFuZWwgPSByZXF1aXJlKCcuL2xpYi9jaGFyYWN0ZXJfc2hlZXRfcGFuZWwuanMnKTtcclxuXHJcbmNsYXNzIENsaWVudCB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHRsZXQgd3N1cmwgPSBcIndzXCIgKyB3aW5kb3cubG9jYXRpb24uaHJlZi5zdWJzdHJpbmcoNCk7IC8vIHJlcGxhY2VzIHRoZSBcImh0dHBcIiB3aXRoIFwid3NcIiAoYW5kIGFsc28gZG9lcyBcImh0dHBzXCIgLT4gXCJ3c3NcIiBhcyB3ZWxsKVxyXG5cdFx0dGhpcy5zb2NrZXQgPSBuZXcgV2ViU29ja2V0KHdzdXJsKTsgLy8gb3BlbiBhIGNvbm5lY3Rpb25cclxuXHRcdHRoaXMuc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLmhhbmRsZV9tZXNzYWdlLmJpbmQodGhpcykpO1xyXG5cclxuXHRcdHRoaXMuY2hhdF93aW5kb3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNoYXR3aW5kb3dcIik7XHJcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1haW4tdGV4dC1pbnB1dFwiKS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLnRleHRfaW5wdXRfa2V5ZG93bi5iaW5kKHRoaXMpKTtcclxuXHRcdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuaGFuZGxlX2NsaWNrLmJpbmQodGhpcykpO1xyXG5cdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIHRoaXMuaGFuZGxlX2NoYW5nZS5iaW5kKHRoaXMpKTtcclxuXHRcdHRoaXMucGxheWVyX25hbWVzID0ge1wiLTFcIjogXCJHTVwifTtcclxuXHJcblx0XHR0aGlzLmNoYXJhY3Rlcl9zaGVldCA9IHt9O1xyXG5cdFx0dGhpcy5jaGFyYWN0ZXJfc2hlZXRzID0ge307IC8vIEdNIG9ubHkgLSB0aGUgb25lIGFib3ZlIGlzIHRoZSBwbGF5ZXIncyBjaGFyIHNoZWV0IGFuZCB0aGlzIG9uZSBhbmQgdGhlIG9uZSBiZWxvdyBhcmUgdGhlIEdNJ3MgY2hhciBzaGVldHMuXHJcblx0XHR0aGlzLmNoYXJfc2hlZXRfcGFuZWxzID0ge307XHJcblx0fVxyXG5cclxuXHRoYW5kbGVfbWVzc2FnZShlKSB7XHJcblx0XHRsZXQgb2JqID0gSlNPTi5wYXJzZShlLmRhdGEpO1xyXG5cdFx0Y29uc29sZS5sb2cob2JqKTtcclxuXHRcdGlmKG9iai5zaG93X2xvZ2luX3BhbmVsKSB7XHJcblx0XHRcdG5ldyBMb2dpblBhbmVsKHRoaXMpO1xyXG5cdFx0fVxyXG5cdFx0aWYob2JqLmJlX2dtKSB7XHJcblx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImlzLWdtXCIpOyAvLyBiYXNpY2FsbHkgeW91IGNhbiBzdGljayB2YXJpb3VzIGNsYXNzZXMgb24gZWxlbWVudHMgdG8gbWFrZSB0aGVtIG9ubHkgdmlzaWJsZSBpZiB5b3VyZSBhIGdtLlxyXG5cdFx0fVxyXG5cdFx0aWYob2JqLmZyb3plbiAhPSBudWxsKSB7IC8vIG9ubHkgZ20gZ2V0cyB0aGlzLlxyXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZyb3plbi1jaGVja2JveFwiKS5jaGVja2VkID0gb2JqLmZyb3plbjtcclxuXHRcdH1cclxuXHRcdGlmKG9iai5hZGRfcGxheWVyKSB7XHJcblx0XHRcdGxldCBwbyA9IG9iai5hZGRfcGxheWVyO1xyXG5cdFx0XHR0aGlzLnBsYXllcl9uYW1lc1twby5pZF0gPSBwby5uYW1lO1xyXG5cdFx0XHRsZXQgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcblx0XHRcdGVsZW0uY2xhc3NMaXN0LmFkZChcInBsYXllci1lbnRyeVwiKTtcclxuXHRcdFx0ZWxlbS5kYXRhc2V0LnBsYXllcm51bSA9IHBvLmlkO1xyXG5cdFx0XHRlbGVtLmlubmVySFRNTCA9IGBcclxuPGRpdiBzdHlsZT0ndGV4dC1hbGlnbjpjZW50ZXI7JHtwby5uYW1lX3N0eWxlfScgY2xhc3M9J3BsYXllci1uYW1lICR7cG8ubmFtZV9jbGFzc30nPjwvZGl2PlxyXG48ZGl2IGNsYXNzPSdnbS1vbmx5JyBzdHlsZT0nZm9udC1zaXplOjEycHg7Zm9udC1zdHlsZTppdGFsaWM7dGV4dC1hbGlnbjpjZW50ZXInPlBsYXllcjwvZGl2PlxyXG48ZGl2PlxyXG5cdDxpbnB1dCB0eXBlPSdidXR0b24nIGNsYXNzPSdwbS1idXR0b24nIHZhbHVlPSdQTSc+XHJcblx0PGlucHV0IHR5cGU9J2J1dHRvbicgY2xhc3M9J2VkaXQtY2hhci1idXR0b24gZ20tb25seScgdmFsdWU9J0VkaXQgQ2hhcmFjdGVyIFNoZWV0Jz5cclxuXHQ8aW5wdXQgdHlwZT0nYnV0dG9uJyBjbGFzcz0nc3Bvb2YtYnV0dG9uIGdtLW9ubHknIHZhbHVlPSdTcG9vZic+XHJcblx0PGxhYmVsIGNsYXNzPSdnbS1vbmx5Jz48aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSdtdXRlLWNoZWNrYm94Jz5NdXRlPC9sYWJlbD5cclxuPC9kaXY+XHJcbmA7XHJcblx0XHRcdGVsZW0ucXVlcnlTZWxlY3RvcignLnBsYXllci1uYW1lJykudGV4dENvbnRlbnQgPSBwby5uYW1lO1xyXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllcnNsaXN0XCIpLmFwcGVuZENoaWxkKGVsZW0pO1xyXG5cdFx0fVxyXG5cdFx0aWYob2JqLmFkZF9ucGMpIHtcclxuXHRcdFx0bGV0IHBvID0gb2JqLmFkZF9ucGM7XHJcblx0XHRcdHRoaXMucGxheWVyX25hbWVzW3BvLmlkXSA9IHBvLm5hbWU7XHJcblx0XHRcdGxldCBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuXHRcdFx0ZWxlbS5jbGFzc0xpc3QuYWRkKFwicGxheWVyLWVudHJ5XCIpO1xyXG5cdFx0XHRlbGVtLmRhdGFzZXQucGxheWVybnVtID0gcG8uaWQ7XHJcblx0XHRcdGVsZW0uaW5uZXJIVE1MID0gYFxyXG48ZGl2IHN0eWxlPSd0ZXh0LWFsaWduOmNlbnRlcjske3BvLm5hbWVfc3R5bGV9JyBjbGFzcz0ncGxheWVyLW5hbWUgJHtwby5uYW1lX2NsYXNzfSc+PC9kaXY+XHJcbjxkaXYgc3R5bGU9J2ZvbnQtc2l6ZToxMnB4O2ZvbnQtc3R5bGU6aXRhbGljO3RleHQtYWxpZ246Y2VudGVyJz5OUEM8L2Rpdj5cclxuPGRpdj5cclxuXHQ8aW5wdXQgdHlwZT0nYnV0dG9uJyBjbGFzcz0nc3Bvb2YtYnV0dG9uIGdtLW9ubHknIHZhbHVlPSdTcG9vZic+XHJcbjwvZGl2PlxyXG5gO1xyXG5cdFx0XHRlbGVtLnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXItbmFtZScpLnRleHRDb250ZW50ID0gcG8ubmFtZTtcclxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJucGNzbGlzdFwiKS5hcHBlbmRDaGlsZChlbGVtKTtcclxuXHRcdH1cclxuXHRcdGlmKG9iai50b19jaGF0KSB7XHJcblx0XHRcdGxldCBpdGVtcyA9IG9iai50b19jaGF0O1xyXG5cdFx0XHRpZighKGl0ZW1zIGluc3RhbmNlb2YgQXJyYXkpKVxyXG5cdFx0XHRcdGl0ZW1zID0gW2l0ZW1zXTtcclxuXHRcdFx0dGhpcy5tb2RpZnlfY2hhdCgoKSA9PiB7XHJcblx0XHRcdFx0Zm9yKGxldCBpdGVtIG9mIGl0ZW1zKSB7XHJcblx0XHRcdFx0XHQvLyB3cmFwIHRoZW0gaW4gZGl2cyBhbmQgdG9zcyB0aGVtIGF0IHRoZSBlbmQgb2YgdGhlIGNoYXQgd2luZG93YFxyXG5cdFx0XHRcdFx0bGV0IG5ld2RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRcdFx0bmV3ZGl2LmlubmVySFRNTCA9IGl0ZW07XHJcblx0XHRcdFx0XHR0aGlzLmNoYXRfd2luZG93LmFwcGVuZENoaWxkKG5ld2Rpdik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHRcdGlmKG9iai5wbGF5ZXJudW0pIHtcclxuXHRcdFx0Ly8gc2V0cyBvdXIgcGxheWVybnVtIHNvIHdlIGNhbiByZXRyaWV2ZSBvdXIgbmFtZVxyXG5cdFx0XHR0aGlzLnBsYXllcm51bSA9IG9iai5wbGF5ZXJudW07XHJcblx0XHR9XHJcblx0XHRpZihvYmouY2hhcmFjdGVyX3NoZWV0KSB7XHJcblx0XHRcdHRoaXMuY2hhcmFjdGVyX3NoZWV0ID0gb2JqLmNoYXJhY3Rlcl9zaGVldDtcclxuXHRcdFx0aWYodGhpcy5jaGFyYWN0ZXJfc2hlZXRfcGFuZWwpXHJcblx0XHRcdFx0dGhpcy5jaGFyYWN0ZXJfc2hlZXRfcGFuZWwudXBkYXRlX2RhdGEodGhpcy5jaGFyYWN0ZXJfc2hlZXQpO1xyXG5cdFx0fVxyXG5cdFx0aWYob2JqLmNoYXJhY3Rlcl9zaGVldHMpIHtcclxuXHRcdFx0T2JqZWN0LmFzc2lnbih0aGlzLmNoYXJhY3Rlcl9zaGVldHMsIG9iai5jaGFyYWN0ZXJfc2hlZXRzKTtcclxuXHRcdFx0Ly8gbm8gbmVlZCB0byB1cGRhdGUgYW55dGhpbmcsIHRoZXJlJ3Mgbm8gcGFuZWxzIG9wZW4gc2luY2UgdGhpcyBpcyBvbmx5IHNlbnQgb24gbG9naW5cclxuXHRcdFx0Ly8gYW5kIG9ubHkgdGhlIEdNIGNhbiBjaGFuZ2UgdGhlIGNoYXJhY3RlciBzaGVldHMuXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRoYW5kbGVfY2xpY2soZSkge1xyXG5cdFx0bGV0IGlucHV0ID0gZS50YXJnZXQuY2xvc2VzdChcImlucHV0XCIpO1xyXG5cdFx0bGV0IHBsYXllcm51bV9lbGVtID0gZS50YXJnZXQuY2xvc2VzdChcIltkYXRhLXBsYXllcm51bV1cIik7XHJcblx0XHRsZXQgcGxheWVybnVtID0gcGxheWVybnVtX2VsZW0gPyBwbGF5ZXJudW1fZWxlbS5kYXRhc2V0LnBsYXllcm51bSA6IG51bGw7XHJcblx0XHRpZihpbnB1dCkge1xyXG5cdFx0XHRpZihpbnB1dC5kYXRhc2V0LmRpY2UpIHtcclxuXHRcdFx0XHRsZXQgbWF4dmFsID0gK2lucHV0LmRhdGFzZXQuZGljZTtcclxuXHRcdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpY2Utb3V0cHV0XCIpLnZhbHVlID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKm1heHZhbCkgKyAxO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGlucHV0LmNsYXNzTGlzdC5jb250YWlucyhcInBtLWJ1dHRvblwiKSAmJiBwbGF5ZXJudW0pIHtcclxuXHRcdFx0XHRuZXcgUHJvbXB0UGFuZWwoYFBNIHRvICR7dGhpcy5wbGF5ZXJfbmFtZXNbcGxheWVybnVtXX1gKS52YWx1ZV9wcm9taXNlKCkudGhlbigodmFsKSA9PiB7XHJcblx0XHRcdFx0XHRpZighdmFsKVxyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR0aGlzLnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtwbToge3RvOiBwbGF5ZXJudW0sIHRleHQ6IHZhbH19KSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoaW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwic3Bvb2YtYnV0dG9uXCIpICYmIHBsYXllcm51bSkge1xyXG5cdFx0XHRcdG5ldyBQcm9tcHRQYW5lbChgU3Bvb2ZpbmcgJHt0aGlzLnBsYXllcl9uYW1lc1twbGF5ZXJudW1dfWApLnZhbHVlX3Byb21pc2UoKS50aGVuKCh2YWwpID0+IHtcclxuXHRcdFx0XHRcdGlmKCF2YWwpXHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdHRoaXMuc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe3Nwb29mOiB7dmljdGltOiBwbGF5ZXJudW0sIHRleHQ6IHZhbH19KSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoaW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2hhci1zaGVldC1idXR0b25cIikgJiYgIXRoaXMuY2hhcl9zaGVldF9wYW5lbCkge1xyXG5cdFx0XHRcdHRoaXMuY2hhcl9zaGVldF9wYW5lbCA9IG5ldyBDaGFyYWN0ZXJTaGVldFBhbmVsKHRoaXMsIGZhbHNlKTtcclxuXHRcdFx0XHR0aGlzLmNoYXJfc2hlZXRfcGFuZWwudXBkYXRlX2RhdGEodGhpcy5jaGFyYWN0ZXJfc2hlZXQpO1xyXG5cdFx0XHRcdHRoaXMuY2hhcl9zaGVldF9wYW5lbC51cGRhdGVfbmFtZSh0aGlzLnBsYXllcl9uYW1lc1t0aGlzLnBsYXllcm51bV0pO1xyXG5cdFx0XHRcdHRoaXMuY2hhcl9zaGVldF9wYW5lbC53YWl0X3VudGlsX2Nsb3NlKCkudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLmNoYXJfc2hlZXRfcGFuZWwgPSBudWxsO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGlucHV0LmNsYXNzTGlzdC5jb250YWlucyhcImVkaXQtY2hhci1idXR0b25cIikgJiYgcGxheWVybnVtICYmICF0aGlzLmNoYXJfc2hlZXRfcGFuZWxzW3BsYXllcm51bV0pIHtcclxuXHRcdFx0XHR0aGlzLmNoYXJfc2hlZXRfcGFuZWxzW3BsYXllcm51bV0gPSBuZXcgQ2hhcmFjdGVyU2hlZXRQYW5lbCh0aGlzLCB0cnVlLCBwbGF5ZXJudW0pO1xyXG5cdFx0XHRcdHRoaXMuY2hhcl9zaGVldF9wYW5lbHNbcGxheWVybnVtXS51cGRhdGVfZGF0YSh0aGlzLmNoYXJhY3Rlcl9zaGVldHNbcGxheWVybnVtXSk7XHJcblx0XHRcdFx0dGhpcy5jaGFyX3NoZWV0X3BhbmVsc1twbGF5ZXJudW1dLnVwZGF0ZV9uYW1lKHRoaXMucGxheWVyX25hbWVzW3BsYXllcm51bV0pO1xyXG5cdFx0XHRcdHRoaXMuY2hhcl9zaGVldF9wYW5lbHNbcGxheWVybnVtXS53YWl0X3VudGlsX2Nsb3NlKCkudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLmNoYXJfc2hlZXRfcGFuZWxzW3BsYXllcm51bV0gPSBudWxsO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRsZXQgcG1fbGluayA9IGUudGFyZ2V0LmNsb3Nlc3QoXCJbZGF0YS1wbV1cIik7XHJcblx0XHRpZihwbV9saW5rKSB7XHJcblx0XHRcdG5ldyBQcm9tcHRQYW5lbChgUE0gcmVwbHlgKS52YWx1ZV9wcm9taXNlKCkudGhlbigodmFsKSA9PiB7XHJcblx0XHRcdFx0aWYoIXZhbClcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR0aGlzLnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtwbToge3RvOiBwbV9saW5rLmRhdGFzZXQucG0sIHRleHQ6IHZhbH19KSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRoYW5kbGVfY2hhbmdlKGUpIHtcclxuXHRcdGxldCBpbnB1dCA9IGUudGFyZ2V0LmNsb3Nlc3QoXCJpbnB1dFwiKTtcclxuXHRcdGxldCBwbGF5ZXJudW1fZWxlbSA9IGUudGFyZ2V0LmNsb3Nlc3QoXCJbZGF0YS1wbGF5ZXJudW1dXCIpO1xyXG5cdFx0bGV0IHBsYXllcm51bSA9IHBsYXllcm51bV9lbGVtID8gcGxheWVybnVtX2VsZW0uZGF0YXNldC5wbGF5ZXJudW0gOiBudWxsO1xyXG5cdFx0aWYoaW5wdXQpIHtcclxuXHRcdFx0aWYoaW5wdXQuaWQgPT0gXCJmcm96ZW4tY2hlY2tib3hcIikge1xyXG5cdFx0XHRcdHRoaXMuc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe2Zyb3plbjogISFpbnB1dC5jaGVja2VkfSkpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGlucHV0LmNsYXNzTGlzdC5jb250YWlucyhcIm11dGUtY2hlY2tib3hcIikgJiYgcGxheWVybnVtKSB7XHJcblx0XHRcdFx0aWYoaW5wdXQuY2hlY2tlZClcclxuXHRcdFx0XHRcdHRoaXMuc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe211dGVfcGxheWVyOiBwbGF5ZXJudW19KSk7XHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0dGhpcy5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7dW5tdXRlX3BsYXllcjogcGxheWVybnVtfSkpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR0ZXh0X2lucHV0X2tleWRvd24oZSkge1xyXG5cdFx0bGV0IHRleHRfaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1haW4tdGV4dC1pbnB1dFwiKTtcclxuXHRcdGlmKGUud2hpY2ggPT0gMTMpIHsgLy8gZW50ZXJcclxuXHRcdFx0bGV0IHRleHQgPSB0ZXh0X2lucHV0LnZhbHVlO1xyXG5cdFx0XHR0ZXh0X2lucHV0LnZhbHVlID0gXCJcIjtcclxuXHRcdFx0dGhpcy5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7Y2hhdDogdGV4dH0pKTtcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0bW9kaWZ5X2NoYXQoY2FsbGJhY2spIHsgLy8gd3JhcCB5b3VyIGNoYXQgbW9kaWZpY2F0aW9ucyB3aXRoIHRoaXMgZnVuY3Rpb24gc28gdGhhdCB0aGUgc2Nyb2xsIGdldHMgdXBkYXRlZCBwcm9wZXJseVxyXG5cdFx0bGV0IGRvX3Njcm9sbCA9IGZhbHNlO1xyXG5cdFx0aWYoTWF0aC5jZWlsKHRoaXMuY2hhdF93aW5kb3cuc2Nyb2xsVG9wICsgdGhpcy5jaGF0X3dpbmRvdy5jbGllbnRIZWlnaHQpID49IE1hdGguZmxvb3IodGhpcy5jaGF0X3dpbmRvdy5zY3JvbGxIZWlnaHQpKSAvLyBjaGVjayBpZiB0aGUgdGhpbmcgaXMgc2Nyb2xsZWQgYWxsIHRoZSB3YXkgZG93blxyXG5cdFx0XHRkb19zY3JvbGwgPSB0cnVlOyAvLyBtYWtlcyBpdCBrZWVwIGl0c2VsZiBzY3JvbGxlZCBkb3duXHJcblx0XHRjYWxsYmFjaygpOyAvLyBub3cgdGhlIGNoYXQgd2luZG93IGdldHMgbW9kaWZpZWRcclxuXHRcdC8vIGFuZCBub3cgd2Ugc2Nyb2xsIGFsbCB0aGUgd2F5IGRvd24gaWYgaXQgd2FzIHRoYXQgd2F5IGJlZm9yZVxyXG5cdFx0aWYoZG9fc2Nyb2xsKVxyXG5cdFx0XHR0aGlzLmNoYXRfd2luZG93LnNjcm9sbFRvcCA9IHRoaXMuY2hhdF93aW5kb3cuc2Nyb2xsSGVpZ2h0IC0gdGhpcy5jaGF0X3dpbmRvdy5jbGllbnRIZWlnaHQ7XHJcblx0fVxyXG59XHJcblxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xyXG5cdC8vIGFscmlnaHR5IGxldCdzIGNvbm5lY3RcclxuXHR3aW5kb3cuY2xpZW50ID0gbmV3IENsaWVudCgpO1xyXG59KTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5jb25zdCBQYW5lbCA9IHJlcXVpcmUoJy4vcGFuZWwuanMnKTtcclxuXHJcbmNsYXNzIENoYXJhY3RlclNoZWV0UGFuZWwgZXh0ZW5kcyBQYW5lbCB7XHJcblx0Y29uc3RydWN0b3IoY2xpZW50LCBlZGl0X21vZGUgPSB0cnVlLCBwbGF5ZXJudW0pIHtcclxuXHRcdHN1cGVyKHt3aWR0aDogNTQwLCBoZWlnaHQ6IDYwMCwgdGl0bGU6XCJDaGFyYWN0ZXIgU2hlZXRcIn0pO1xyXG5cdFx0dGhpcy5jbGllbnQgPSBjbGllbnQ7XHJcblx0XHR0aGlzLnBsYXllcm51bSA9IHBsYXllcm51bTtcclxuXHRcdHRoaXMuY29udGVudF9vYmouaW5uZXJIVE1MID1gXHJcbjxkaXY+PGlucHV0IHR5cGU9J2J1dHRvbicgY2xhc3M9J3NhdmUtYnV0dG9uJyB2YWx1ZSA9IFwiU2F2ZSBhbmQgU2VuZCBTaGVldFwiPjwvZGl2PlxyXG48aDEgY2xhc3M9XCJjaGFybmFtZVwiPkdlbi1SLUlDQy0xPC9oMT5cclxuPGRpdiBjbGFzcz0nbGVmdC1wYXJ0Jz5cclxuXHQ8ZGl2IGNsYXNzPSdtYXJnaW5zJz48Yj5TZXJ2aWNlIEdyb3VwOiA8L2I+PHNwYW4gZGF0YS1jc2ZpZWxkPVwic2VydmljZV9ncm91cFwiPjwvc3Bhbj48L2Rpdj5cclxuXHQ8ZGl2IGNsYXNzPSdtYXJnaW5zJz48Yj5GaXJtOiA8L2I+PHNwYW4gZGF0YS1jc2ZpZWxkPVwiZmlybVwiPjwvc3Bhbj48L2Rpdj5cclxuXHQ8ZGl2IGNsYXNzPSdtYXJnaW5zJz48Yj5HZW5kZXI6IDwvYj48c3BhbiBkYXRhLWNzZmllbGQ9XCJnZW5kZXJcIj48L3NwYW4+PC9kaXY+XHJcblx0PGRpdiBjbGFzcz0nbWFyZ2lucyc+PGI+VGljczogPC9iPjxzcGFuIGRhdGEtY3NmaWVsZD1cInRpY3NcIiBjbGFzcz0nZnVsbHdpZHRoJz48L3NwYW4+PC9kaXY+XHJcblx0PHRhYmxlIGNsYXNzPSdtYXJnaW5zJz5cclxuXHRcdDx0cj5cclxuXHRcdFx0PHRkPjxiPk1CRDogPC9iPjwvdGQ+XHJcblx0XHRcdDx0ZD48bGFiZWw+PGlucHV0IHR5cGU9J2NoZWNrYm94JyBkYXRhLWNzZmllbGQ9XCJtYmQxXCI+VGVhbSBMZWFkZXI8L2xhYmVsPjwvdGQ+XHJcblx0XHRcdDx0ZD48bGFiZWw+PGlucHV0IHR5cGU9J2NoZWNrYm94JyBkYXRhLWNzZmllbGQ9XCJtYmQzXCI+TG95YWx0eSBPZmZpY2VyPC9sYWJlbD48L3RkPlxyXG5cdFx0XHQ8dGQ+PGxhYmVsPjxpbnB1dCB0eXBlPSdjaGVja2JveCcgZGF0YS1jc2ZpZWxkPVwibWJkNVwiPkh5Z2llbmUgT2ZmaWNlcjwvbGFiZWw+PC90ZD5cclxuXHRcdDwvdHI+XHJcblx0XHQ8dHI+XHJcblx0XHRcdDx0ZD48L3RkPlxyXG5cdFx0XHQ8dGQ+PGxhYmVsPjxpbnB1dCB0eXBlPSdjaGVja2JveCcgZGF0YS1jc2ZpZWxkPVwibWJkMlwiPkMmUk88L2xhYmVsPjwvdGQ+XHJcblx0XHRcdDx0ZD48bGFiZWw+PGlucHV0IHR5cGU9J2NoZWNrYm94JyBkYXRhLWNzZmllbGQ9XCJtYmQ0XCI+RXF1aXBtZW50IEd1eTwvbGFiZWw+PC90ZD5cclxuXHRcdFx0PHRkPjxsYWJlbD48aW5wdXQgdHlwZT0nY2hlY2tib3gnIGRhdGEtY3NmaWVsZD1cIm1iZDZcIj5IYXBwaW5lc3MgT2ZmaWNlcjwvbGFiZWw+PC90ZD5cclxuXHRcdDwvdHI+XHJcblx0XHQ8dHI+XHJcblx0XHRcdDx0ZD48L3RkPlxyXG5cdFx0XHQ8dGQgY29sc3Bhbj0zPjxpbnB1dCB0eXBlPSdjaGVja2JveCcgZGF0YS1jc2ZpZWxkPVwibWJkX2N1c3RvbVwiPjxzcGFuIGRhdGEtY3NmaWVsZD1cIm1iZF9jdXN0b21fbmFtZVwiPjwvc3Bhbj48L3RkPlxyXG5cdFx0PC90cj5cclxuXHQ8L3RhYmxlPlxyXG48L2Rpdj5cclxuYDtcclxuXHRcdGZvcihsZXQgZWxlbSBvZiB0aGlzLiQkKCdbZGF0YS1jc2ZpZWxkXScpKSB7XHJcblx0XHRcdGlmKGVsZW0udGFnTmFtZSA9PSBcIklOUFVUXCIpIHtcclxuXHRcdFx0XHRpZihlbGVtLnR5cGUgPT0gXCJjaGVja2JveFwiKSB7XHJcblx0XHRcdFx0XHRpZighZWRpdF9tb2RlKVxyXG5cdFx0XHRcdFx0XHRlbGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSk9PntlLnByZXZlbnREZWZhdWx0KCk7IHJldHVybiBmYWxzZTt9KTsgLy8gcHJldmVudCBjbGljayBldmVudHMuIFRoZSBjaGVja2JveCBpcyBuZWFybHkgdW5yZWFkYWJsZSBpZiBpdCdzIGdyZXksIHNvIGRvaW5nIHRoaXMgaW5zdGVhZFxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRlbGVtLnJlYWRvbmx5ID0gIWVkaXRfbW9kZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZWxlbS5jb250ZW50RWRpdGFibGUgPSBlZGl0X21vZGU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZihlZGl0X21vZGUpIHtcclxuXHRcdFx0dGhpcy4kKCcuc2F2ZS1idXR0b24nKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0XHRcdGxldCBkYXRhID0gdGhpcy5nZXRfZGF0YSgpO1xyXG5cdFx0XHRcdGNsaWVudC5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7dXBkYXRlX2NoYXJhY3Rlcl9zaGVldDoge2ZvcjogdGhpcy5wbGF5ZXJudW0sIGRhdGF9fSkpO1xyXG5cdFx0XHRcdHRoaXMuY2xpZW50LmNoYXJhY3Rlcl9zaGVldHNbdGhpcy5wbGF5ZXJudW1dID0gZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLiQoJy5zYXZlLWJ1dHRvbicpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjsgLy8gcmVlIGdldCByaWQgb2YgdGhhdCBidXR0b25cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHVwZGF0ZV9uYW1lKG5hbWUpIHtcclxuXHRcdHRoaXMuJCgnLmNoYXJuYW1lJykudGV4dENvbnRlbnQgPSBuYW1lO1xyXG5cdH1cclxuXHR1cGRhdGVfZGF0YShkYXRhKSB7XHJcblx0XHRpZighZGF0YSlcclxuXHRcdFx0cmV0dXJuOyAvLyBvb2ggaXQncyBibGFuay5cclxuXHRcdGZvcihsZXQgZWxlbSBvZiB0aGlzLiQkKCdbZGF0YS1jc2ZpZWxkXScpKSB7XHJcblx0XHRcdGxldCBrZXkgPSBlbGVtLmRhdGFzZXQuY3NmaWVsZDtcclxuXHRcdFx0aWYoZWxlbS50YWdOYW1lID09IFwiSU5QVVRcIikge1xyXG5cdFx0XHRcdGlmKGVsZW0udHlwZSA9PSBcImNoZWNrYm94XCIpIHsgLy9jaGVja2JveGVzIHVzZSBjaGVja2VkIGluc3RlYWQgb2YgdmFsdWVcclxuXHRcdFx0XHRcdGVsZW0uY2hlY2tlZCA9IGRhdGFba2V5XTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0ZWxlbS52YWx1ZSA9IHN0cmluZ193cmFwcGVyKGRhdGFba2V5XSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGVsZW0uaW5uZXJIVE1MID0gc3RyaW5nX3dyYXBwZXIoZGF0YVtrZXldKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRnZXRfZGF0YSgpIHsgLy8gbGl0ZXJhbGx5IHRoZSBzYW1lIGFzIHVwZGF0ZV9kYXRhIGJ1dCB0aGUgYXNzaWdubWVudHMgYXJlIHN3YXBwZWQuXHJcblx0XHRsZXQgZGF0YSA9IHt9O1xyXG5cdFx0Zm9yKGxldCBlbGVtIG9mIHRoaXMuJCQoJ1tkYXRhLWNzZmllbGRdJykpIHtcclxuXHRcdFx0bGV0IGtleSA9IGVsZW0uZGF0YXNldC5jc2ZpZWxkO1xyXG5cdFx0XHRpZihlbGVtLnRhZ05hbWUgPT0gXCJJTlBVVFwiKSB7XHJcblx0XHRcdFx0aWYoZWxlbS50eXBlID09IFwiY2hlY2tib3hcIikge1xyXG5cdFx0XHRcdFx0ZGF0YVtrZXldID0gZWxlbS5jaGVja2VkO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRkYXRhW2tleV0gPSBlbGVtLnZhbHVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRkYXRhW2tleV0gPSBlbGVtLmlubmVySFRNTDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRhdGE7XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBzdHJpbmdfd3JhcHBlcihvYmopIHsgLy8gcHJldmVudHMgdGhpbmdzIGxpa2UgXCJ1bmRlZmluZWRcIiBhbmQgXCJudWxsXCIgc2hvd2luZyB1cC5cclxuXHRpZihvYmogPT0gbnVsbClcclxuXHRcdHJldHVybiBcIlwiO1xyXG5cdGVsc2VcclxuXHRcdHJldHVybiBcIlwiK29iajtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDaGFyYWN0ZXJTaGVldFBhbmVsO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcbmNvbnN0IFBhbmVsID0gcmVxdWlyZSgnLi9wYW5lbC5qcycpO1xyXG5cclxuY2xhc3MgTG9naW5QYW5lbCBleHRlbmRzIFBhbmVsIHtcclxuXHRjb25zdHJ1Y3RvcihjbGllbnQpIHtcclxuXHRcdHN1cGVyKHt3aWR0aDogMjQwLCBoZWlnaHQ6IDI4OCwgdGl0bGU6IFwiTG9naW5cIiwgY2FuX2Nsb3NlOiBmYWxzZX0pO1xyXG5cdFx0dGhpcy5jbGllbnQgPSBjbGllbnQ7XHJcblx0XHR0aGlzLmNvbnRlbnRfb2JqLmlubmVySFRNTCA9IGBcclxuPGZvcm0+XHJcbjxkaXYgc3R5bGU9J2Rpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246bGVmdCc+XHJcblx0PGRpdiBjbGFzcz0nYXZhaWxhYmxlX3BsYXllcnMnPjwvZGl2PlxyXG5cdDxsYWJlbD48aW5wdXQgdHlwZT0ncmFkaW8nIGNsYXNzPSdvYnNlcnZlLWNoZWNrYm94JyBuYW1lPSdsb2dpbi10eXBlJyB2YWx1ZT0nb2JzZXJ2ZScgY2hlY2tlZD5PYnNlcnZlPC9sYWJlbD5cclxuPC9kaXY+PGJyPjwvZm9ybT5cclxuPGlucHV0IHR5cGU9J3Bhc3N3b3JkJyBjbGFzcz0ncGFzc3dvcmQtZmllbGQnIHBsYWNlaG9sZGVyPVwiUGFzc3dvcmQgKGRlZmF1bHQgaXMgJ2FzZGYnKVwiIGRpc2FibGVkPjxicj5cclxuPGRpdiBzdHlsZT0nY29sb3I6cmVkJyBjbGFzcz0nbG9naW4tZmFpbC1yZWFzb24nPjwvZGl2PlxyXG48aW5wdXQgdHlwZT0nYnV0dG9uJyBjbGFzcz0nbG9naW4tYnV0dG9uJyB2YWx1ZT0nTG9naW4nPjwvaW5wdXQ+XHJcbmA7XHJcblx0XHR0aGlzLiQoJy5sb2dpbi1idXR0b24nKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0XHRsZXQgc2VsZWN0ZWRfZWxlbSA9IHRoaXMuJCgnaW5wdXQ6Y2hlY2tlZCcpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhzZWxlY3RlZF9lbGVtKTtcclxuXHRcdFx0aWYoc2VsZWN0ZWRfZWxlbS5kYXRhc2V0LnBsYXllcm51bSkge1xyXG5cdFx0XHRcdGxldCBzZWxfcGxheWVyID0gK3NlbGVjdGVkX2VsZW0uZGF0YXNldC5wbGF5ZXJudW07XHJcblx0XHRcdFx0bGV0IHBhc3N3b3JkID0gdGhpcy4kKCcucGFzc3dvcmQtZmllbGQnKS52YWx1ZTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIkdPIVwiKTtcclxuXHRcdFx0XHR0aGlzLmNsaWVudC5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7cGFzc3dvcmQsIHNlbF9wbGF5ZXIsIGxvZ2luOiB0cnVlfSkpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHRoaXMuY29udGVudF9vYmouYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZSkgPT4geyAvLyBoYW5kbGUgb2JzZXJ2ZWQgY2hhbmdlc1xyXG5cdFx0XHRjb25zb2xlLmxvZyhlKTtcclxuXHRcdFx0dGhpcy4kKCcucGFzc3dvcmQtZmllbGQnKS5kaXNhYmxlZCA9IHRoaXMuJCgnLm9ic2VydmUtY2hlY2tib3gnKS5jaGVja2VkO1xyXG5cdFx0fSk7XHJcblx0XHR0aGlzLmhhbmRsZV9tZXNzYWdlID0gdGhpcy5oYW5kbGVfbWVzc2FnZS5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5jbGllbnQuc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMuaGFuZGxlX21lc3NhZ2UpO1xyXG5cdH1cclxuXHJcblx0aGFuZGxlX21lc3NhZ2UoZSkge1xyXG5cdFx0bGV0IG9iaiA9IEpTT04ucGFyc2UoZS5kYXRhKTtcclxuXHRcdGlmKG9iai5hdmFpbF9wbGF5ZXJzKSB7XHJcblx0XHRcdGxldCBjdXJyX3BsYXllcm51bSA9IHRoaXMuJChgLmF2YWlsYWJsZV9wbGF5ZXJzIGlucHV0W2NoZWNrZWRdYCk7XHJcblx0XHRcdGN1cnJfcGxheWVybnVtID0gY3Vycl9wbGF5ZXJudW0gJiYgK2N1cnJfcGxheWVybnVtLmRhdGFzZXQucGxheWVybnVtOyAvLyBnZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBwbGF5ZXIgaWYgdGhlcmVzIGEgY2hlY2tlZCBlbGVtZW50XHJcblx0XHRcdHRoaXMuJChgLmF2YWlsYWJsZV9wbGF5ZXJzYCkuaW5uZXJIVE1MID0gXCJcIjsgLy8gY2xlYXIgaXQuXHJcblx0XHRcdGZvcihsZXQgW2tleSwgdmFsXSBvZiBPYmplY3QuZW50cmllcyhvYmouYXZhaWxfcGxheWVycykpIHtcclxuXHRcdFx0XHRsZXQgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcblx0XHRcdFx0bGFiZWwudGV4dENvbnRlbnQgPSB2YWw7XHJcblx0XHRcdFx0bGFiZWwuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjsgLy8gc28gdGhhdCB0aGV5IGVhY2ggYXJlIG9uIGRpZmZlcmVudCBsaW5lc1xyXG5cdFx0XHRcdGxldCByYWRpb2J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuXHRcdFx0XHRyYWRpb2J1dHRvbi50eXBlID0gXCJyYWRpb1wiO1xyXG5cdFx0XHRcdHJhZGlvYnV0dG9uLmRhdGFzZXQucGxheWVybnVtID0ga2V5O1xyXG5cdFx0XHRcdHJhZGlvYnV0dG9uLm5hbWUgPSBcImxvZ2luLXR5cGVcIjtcclxuXHRcdFx0XHRsYWJlbC5wcmVwZW5kKHJhZGlvYnV0dG9uKTsgLy8gYWRkIGl0IGJlZm9yZSB0aGUgdGV4dFxyXG5cdFx0XHRcdHRoaXMuJChgLmF2YWlsYWJsZV9wbGF5ZXJzYCkuYXBwZW5kQ2hpbGQobGFiZWwpO1xyXG5cdFx0XHRcdGlmKCtrZXkgPT0gY3Vycl9wbGF5ZXJudW0pIHtcclxuXHRcdFx0XHRcdHJhZGlvYnV0dG9uLmNoZWNrZWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0Y3Vycl9wbGF5ZXJudW0gPSBudWxsOyAvLyBtYXJrIHRoYXQgd2UndmUgcmVzb2x2ZWQgdGhpcyBhbmQgZG9uJ3QgbmVlZCB0byBjaGVjayB0aGUgb2JzZXJ2ZS5cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoY3Vycl9wbGF5ZXJudW0pIHsgLy8gdGhlcmUgd2FzIGEgcGxheWVyIGNoZWNrZWQsIGJ1dCBpdCdzIGdvbmUgbm93LCBzbyBnbyBiYWNrIHRvIG9ic2VydmVcclxuXHRcdFx0XHR0aGlzLiQoYC5vYnNlcnZlLWNoZWNrYm94YCkuY2hlY2tlZCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmKG9iai5sb2dpbl9mYWlsKSB7XHJcblx0XHRcdHRoaXMuJCgnLmxvZ2luLWZhaWwtcmVhc29uJykudGV4dENvbnRlbnQgPSBvYmoubG9naW5fZmFpbDtcclxuXHRcdH1cclxuXHRcdGlmKG9iai5sb2dpbl9zdWNjZXNzKSB7XHJcblx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGNsb3NlKCkge1xyXG5cdFx0dGhpcy5jbGllbnQuc29ja2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMuaGFuZGxlX21lc3NhZ2UpO1xyXG5cdFx0c3VwZXIuY2xvc2UoLi4uYXJndW1lbnRzKTtcclxuXHR9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTG9naW5QYW5lbDtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuY2xhc3MgUGFuZWwge1xyXG5cdGNvbnN0cnVjdG9yKHt3aWR0aD00MDAsIGhlaWdodD00MDAsIHRpdGxlPVwiXCIsIGNhbl9jbG9zZSA9IHRydWV9ID0ge30pIHtcclxuXHRcdHZhciBsZWZ0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIC8gMiAtIHdpZHRoIC8gMjtcclxuXHRcdHZhciB0b3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC8gMiAtIGhlaWdodCAvIDI7XHJcblx0XHR0aGlzLmNvbnRhaW5lcl9vYmogPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdE9iamVjdC5hc3NpZ24odGhpcy5jb250YWluZXJfb2JqLnN0eWxlLCB7d2lkdGg6d2lkdGgrXCJweFwiLCBoZWlnaHQ6aGVpZ2h0K1wicHhcIiwgbGVmdDpsZWZ0K1wicHhcIiwgdG9wOnRvcCtcInB4XCJ9KTtcclxuXHRcdHRoaXMuY29udGFpbmVyX29iai5jbGFzc0xpc3QuYWRkKCd1aWZyYW1lLWNvbnRhaW5lcicpO1xyXG5cdFx0dGhpcy5wYW5lbF9vYmogPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdHRoaXMucGFuZWxfb2JqLmNsYXNzTGlzdC5hZGQoJ3VpZnJhbWUnKTtcclxuXHRcdHRoaXMucGFuZWxfb2JqLnRhYkluZGV4ID0gLTE7XHJcblx0XHR0aGlzLmhlYWRlcl9vYmogPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdHRoaXMuaGVhZGVyX29iai5jbGFzc0xpc3QuYWRkKCd1aWZyYW1lLWhlYWRlcicpO1xyXG5cdFx0dGhpcy50aXRsZV9ub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGl0bGUpO1xyXG5cdFx0dGhpcy5oZWFkZXJfb2JqLmFwcGVuZENoaWxkKHRoaXMudGl0bGVfbm9kZSk7XHJcblx0XHR0aGlzLmNvbnRlbnRfb2JqID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHR0aGlzLmNvbnRlbnRfb2JqLmNsYXNzTGlzdC5hZGQoJ3VpZnJhbWUtY29udGVudCcpO1xyXG5cdFx0dGhpcy5wYW5lbF9vYmouYXBwZW5kQ2hpbGQodGhpcy5oZWFkZXJfb2JqKTtcclxuXHRcdHRoaXMucGFuZWxfb2JqLmFwcGVuZENoaWxkKHRoaXMuY29udGVudF9vYmopO1xyXG5cdFx0dGhpcy5jb250YWluZXJfb2JqLmFwcGVuZENoaWxkKHRoaXMucGFuZWxfb2JqKTtcclxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1aWZyYW1lcy1jb250YWluZXInKS5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lcl9vYmopO1xyXG5cclxuXHRcdHRoaXMuaGVhZGVyX29iai5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX3N0YXJ0X2RyYWcuYmluZCh0aGlzKSk7XHJcblx0XHR0aGlzLmNvbnRhaW5lcl9vYmouYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9zdGFydF9yZXNpemUuYmluZCh0aGlzKSk7XHJcblx0XHR0aGlzLmNvbnRhaW5lcl9vYmouYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCB0aGlzLl9jb250YWluZXJfbW91c2Vtb3ZlLmJpbmQodGhpcykpO1xyXG5cdFx0dGhpcy5jb250YWluZXJfb2JqLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCB0aGlzLl9jb250YWluZXJfbW91c2VvdXQuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0dGhpcy5jYW5fY2xvc2UgPSBjYW5fY2xvc2U7XHJcblxyXG5cdFx0aWYoY2FuX2Nsb3NlKSB7XHJcblx0XHRcdHRoaXMuY2xvc2VfYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRcdHRoaXMuY2xvc2VfYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3VpZnJhbWUtY2xvc2UtYnV0dG9uJyk7XHJcblx0XHRcdHRoaXMuaGVhZGVyX29iai5hcHBlbmRDaGlsZCh0aGlzLmNsb3NlX2J1dHRvbik7XHJcblxyXG5cdFx0XHR0aGlzLmNsb3NlX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdHRoaXMuY2xvc2VfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0X3N0YXJ0X2RyYWcoZSkge1xyXG5cdFx0aWYoZS5kZWZhdWx0UHJldmVudGVkKVxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHRpZihlLnRhcmdldCAhPSB0aGlzLmhlYWRlcl9vYmopIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0dmFyIHBhZCA9ICh0aGlzLmNvbnRhaW5lcl9vYmoub2Zmc2V0V2lkdGggLSB0aGlzLnBhbmVsX29iai5vZmZzZXRXaWR0aCkvMjtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdHRoaXMucGFuZWxfb2JqLmZvY3VzKCk7XHJcblx0XHR2YXIgbGFzdGNsaWVudHggPSBlLmNsaWVudFg7XHJcblx0XHR2YXIgbGFzdGNsaWVudHkgPSBlLmNsaWVudFk7XHJcblx0XHR2YXIgbW91c2Vtb3ZlID0gKGUpID0+IHtcclxuXHRcdFx0dmFyIGR4ID0gZS5jbGllbnRYIC0gbGFzdGNsaWVudHg7XHJcblx0XHRcdHZhciBkeSA9IGUuY2xpZW50WSAtIGxhc3RjbGllbnR5O1xyXG5cdFx0XHRsYXN0Y2xpZW50eCA9IGUuY2xpZW50WDtcclxuXHRcdFx0bGFzdGNsaWVudHkgPSBlLmNsaWVudFk7XHJcblx0XHRcdHZhciB7bGVmdDpvbGRsZWZ0LCB0b3A6b2xkdG9wfSA9IHRoaXMuY29udGFpbmVyX29iai5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHRcdFx0dGhpcy5jb250YWluZXJfb2JqLnN0eWxlLmxlZnQgPSBNYXRoLm1pbihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgtMTYwLXBhZCwgTWF0aC5tYXgoLXBhZCxvbGRsZWZ0ICsgZHgpKSArIFwicHhcIjtcclxuXHRcdFx0dGhpcy5jb250YWluZXJfb2JqLnN0eWxlLnRvcCA9IE1hdGgubWluKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQtMzUtcGFkLCBNYXRoLm1heCgtcGFkLG9sZHRvcCArIGR5KSkgKyBcInB4XCI7XHJcblx0XHR9O1xyXG5cdFx0dmFyIG1vdXNldXAgPSAoKSA9PiB7XHJcblx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgbW91c2Vtb3ZlKTtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgbW91c2V1cCk7XHJcblx0XHR9O1xyXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBtb3VzZW1vdmUpO1xyXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgbW91c2V1cCk7XHJcblx0fVxyXG5cclxuXHRfcmVzaXplX21ldGEoZSkgeyAvLyBmaWd1cmUgb3V0IHdoaWNoIGVkZ2UgdGhlIG1vdXNlIGN1cnNvciBpcyBvbiBhbmQgcmV0dXJuIGFuIG9iamVjdCB3aXRoIHRoZSBhcHByb3ByaWF0ZSBmbGFnc1xyXG5cdFx0dmFyIHBhZCA9ICh0aGlzLmNvbnRhaW5lcl9vYmoub2Zmc2V0V2lkdGggLSB0aGlzLnBhbmVsX29iai5vZmZzZXRXaWR0aCkvMjtcclxuXHRcdHZhciB3aWR0aCA9IHRoaXMucGFuZWxfb2JqLm9mZnNldFdpZHRoO1xyXG5cdFx0dmFyIGhlaWdodCA9IHRoaXMucGFuZWxfb2JqLm9mZnNldEhlaWdodDtcclxuXHRcdHZhciBvdXQgPSB7ZHJhZ19yaWdodDogZmFsc2UsIGRyYWdfbGVmdDogZmFsc2UsIGRyYWdfdXA6IGZhbHNlLCBkcmFnX2Rvd246IGZhbHNlLCBjdXJzb3I6IFwiZGVmYXVsdFwifTtcclxuXHRcdGlmKGUudGFyZ2V0ID09IHRoaXMuY29udGFpbmVyX29iaikge1xyXG5cdFx0XHRpZihlLm9mZnNldFggPCBwYWQpXHJcblx0XHRcdFx0b3V0LmRyYWdfbGVmdCA9IHRydWU7XHJcblx0XHRcdGlmKGUub2Zmc2V0WSA8IHBhZClcclxuXHRcdFx0XHRvdXQuZHJhZ191cCA9IHRydWU7XHJcblx0XHRcdGlmKGUub2Zmc2V0WCA+ICh3aWR0aCArIHBhZCkpXHJcblx0XHRcdFx0b3V0LmRyYWdfcmlnaHQgPSB0cnVlO1xyXG5cdFx0XHRpZihlLm9mZnNldFkgPiAoaGVpZ2h0ICsgcGFkKSlcclxuXHRcdFx0XHRvdXQuZHJhZ19kb3duID0gdHJ1ZTtcclxuXHRcdFx0aWYoKG91dC5kcmFnX2xlZnQgJiYgb3V0LmRyYWdfZG93bikgfHwgKG91dC5kcmFnX3VwICYmIG91dC5kcmFnX3JpZ2h0KSkge1xyXG5cdFx0XHRcdG91dC5jdXJzb3IgPSBcIm5lc3ctcmVzaXplXCI7XHJcblx0XHRcdH0gZWxzZSBpZigob3V0LmRyYWdfbGVmdCAmJiBvdXQuZHJhZ191cCkgfHwgKG91dC5kcmFnX2Rvd24gJiYgb3V0LmRyYWdfcmlnaHQpKSB7XHJcblx0XHRcdFx0b3V0LmN1cnNvciA9IFwibndzZS1yZXNpemVcIjtcclxuXHRcdFx0fSBlbHNlIGlmKG91dC5kcmFnX2xlZnQgfHwgb3V0LmRyYWdfcmlnaHQpIHtcclxuXHRcdFx0XHRvdXQuY3Vyc29yID0gXCJldy1yZXNpemVcIjtcclxuXHRcdFx0fSBlbHNlIGlmKG91dC5kcmFnX3VwIHx8IG91dC5kcmFnX2Rvd24pIHtcclxuXHRcdFx0XHRvdXQuY3Vyc29yID0gXCJucy1yZXNpemVcIjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0b3V0LmNhbl9yZXNpemUgPSBvdXQuZHJhZ19yaWdodCB8fCBvdXQuZHJhZ19sZWZ0IHx8IG91dC5kcmFnX3VwIHx8IG91dC5kcmFnX2Rvd247XHJcblx0XHRyZXR1cm4gb3V0O1xyXG5cdH1cclxuXHJcblx0X3N0YXJ0X3Jlc2l6ZShlKSB7XHJcblx0XHQvLyBicmluZyB0aGUgcGFuZWwgdG8gdGhlIGZyb250XHJcblx0XHRpZih0aGlzLmNvbnRhaW5lcl9vYmogIT0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VpZnJhbWVzLWNvbnRhaW5lcicpLmxhc3RDaGlsZClcclxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VpZnJhbWVzLWNvbnRhaW5lcicpLmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyX29iaik7XHJcblxyXG5cdFx0Ly8gZmlndXJlIG91dCB3aGljaCBlZGdlcyB3ZSdyZSByZXNpemluZ1xyXG5cdFx0dmFyIHJlc2l6ZV9tZXRhID0gdGhpcy5fcmVzaXplX21ldGEoZSk7XHJcblx0XHRpZighcmVzaXplX21ldGEuY2FuX3Jlc2l6ZSkgLy8gb29mIHdlJ3JlIG5vdCByZXNpemluZ1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHQvLyBmaWd1cmUgb3V0IGhvdyBtdWNoIHNwYWNlIGlzIGFyb3VuZCB0aGUgZWRnZXNcclxuXHRcdHZhciBwYWQgPSAodGhpcy5jb250YWluZXJfb2JqLm9mZnNldFdpZHRoIC0gdGhpcy5wYW5lbF9vYmoub2Zmc2V0V2lkdGgpLzI7XHJcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHR0aGlzLnBhbmVsX29iai5mb2N1cygpO1xyXG5cdFx0dmFyIGxhc3RjbGllbnR4ID0gZS5jbGllbnRYO1xyXG5cdFx0dmFyIGxhc3RjbGllbnR5ID0gZS5jbGllbnRZO1xyXG5cdFx0Ly8gbm93IHN0YXJ0IGRyYWdnaW5nXHJcblx0XHR2YXIgbW91c2Vtb3ZlID0gKGUpID0+IHtcclxuXHRcdFx0dmFyIGR4ID0gZS5jbGllbnRYIC0gbGFzdGNsaWVudHg7XHJcblx0XHRcdHZhciBkeSA9IGUuY2xpZW50WSAtIGxhc3RjbGllbnR5O1xyXG5cdFx0XHRsYXN0Y2xpZW50eCA9IGUuY2xpZW50WDtcclxuXHRcdFx0bGFzdGNsaWVudHkgPSBlLmNsaWVudFk7IC8vIGZpZ3VyZSBvdXQgaG93IG11Y2ggd2UgbW92ZWRcclxuXHRcdFx0dmFyIHtsZWZ0Om9sZGxlZnQsIHRvcDpvbGR0b3B9ID0gdGhpcy5jb250YWluZXJfb2JqLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cdFx0XHRpZihyZXNpemVfbWV0YS5kcmFnX2xlZnQpIHsgLy8gYW5kIG5vdyByZXNpemUgb3Vyc2VsdmVzXHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJfb2JqLnN0eWxlLmxlZnQgPSBNYXRoLm1pbihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgtMTYwLXBhZCxNYXRoLm1heCgtcGFkLG9sZGxlZnQgKyBkeCkpICsgXCJweFwiO1xyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyX29iai5zdHlsZS53aWR0aCA9IE1hdGgubWF4KDE2MCx0aGlzLnBhbmVsX29iai5jbGllbnRXaWR0aCAtIGR4KSArIFwicHhcIjtcclxuXHRcdFx0fSBlbHNlIGlmKHJlc2l6ZV9tZXRhLmRyYWdfcmlnaHQpIHtcclxuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcl9vYmouc3R5bGUud2lkdGggPSBNYXRoLm1heCgxNjAsdGhpcy5wYW5lbF9vYmouY2xpZW50V2lkdGggKyBkeCkgKyBcInB4XCI7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYocmVzaXplX21ldGEuZHJhZ191cCkge1xyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyX29iai5zdHlsZS50b3AgPSBNYXRoLm1pbihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0LTM1LXBhZCxNYXRoLm1heCgtcGFkLG9sZHRvcCArIGR5KSkgKyBcInB4XCI7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJfb2JqLnN0eWxlLmhlaWdodCA9IE1hdGgubWF4KDM1LHRoaXMucGFuZWxfb2JqLmNsaWVudEhlaWdodCAtIGR5KSArIFwicHhcIjtcclxuXHRcdFx0fSBlbHNlIGlmKHJlc2l6ZV9tZXRhLmRyYWdfZG93bikge1xyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyX29iai5zdHlsZS5oZWlnaHQgPSBNYXRoLm1heCgzNSx0aGlzLnBhbmVsX29iai5jbGllbnRIZWlnaHQgKyBkeSkgKyBcInB4XCI7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHR2YXIgbW91c2V1cCA9ICgpID0+IHtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBtb3VzZW1vdmUpO1xyXG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBtb3VzZXVwKTtcclxuXHRcdH07XHJcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIG1vdXNlbW92ZSk7XHJcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBtb3VzZXVwKTtcclxuXHR9XHJcblxyXG5cdF9jb250YWluZXJfbW91c2Vtb3ZlKGUpIHtcclxuXHRcdHZhciByZXNpemVfbWV0YSA9IHRoaXMuX3Jlc2l6ZV9tZXRhKGUpO1xyXG5cdFx0dGhpcy5jb250YWluZXJfb2JqLnN0eWxlLmN1cnNvciA9IHJlc2l6ZV9tZXRhLmN1cnNvcjtcclxuXHR9XHJcblx0X2NvbnRhaW5lcl9tb3VzZW91dCgpIHtcclxuXHRcdHRoaXMuY29udGFpbmVyX29iai5zdHlsZS5jdXJzb3IgPSBcImRlZmF1bHRcIjtcclxuXHR9XHJcblxyXG5cdGdldCB0aXRsZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLnRpdGxlX25vZGUudGV4dENvbnRlbnQ7XHJcblx0fVxyXG5cclxuXHRzZXQgdGl0bGUodmFsKSB7XHJcblx0XHR0aGlzLnRpdGxlX25vZGUudGV4dENvbnRlbnQgPSB2YWw7XHJcblx0fVxyXG5cclxuXHRjbG9zZSgpIHtcclxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1aWZyYW1lcy1jb250YWluZXInKS5yZW1vdmVDaGlsZCh0aGlzLmNvbnRhaW5lcl9vYmopOyAvLyByZW1vdmUgb3Vyc2VsdmVzIVxyXG5cdFx0aWYodGhpcy5jbG9zZV9wcm9taXNlX3Jlc29sdmUpXHJcblx0XHRcdHRoaXMuY2xvc2VfcHJvbWlzZV9yZXNvbHZlKCk7XHJcblx0fVxyXG5cclxuXHR3YWl0X3VudGlsX2Nsb3NlKCkge1xyXG5cdFx0aWYodGhpcy5jbG9zZV9wcm9taXNlKVxyXG5cdFx0XHRyZXR1cm4gdGhpcy5jbG9zZV9wcm9taXNlO1xyXG5cdFx0cmV0dXJuIHRoaXMuY2xvc2VfcHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xyXG5cdFx0XHR0aGlzLmNsb3NlX3Byb21pc2VfcmVzb2x2ZSA9IHJlc29sdmU7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8vIGNvbnZlbmllbmNlIGZ1bmN0aW9uc1xyXG5cdCQoc2VsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5jb250ZW50X29iai5xdWVyeVNlbGVjdG9yKHNlbCk7XHJcblx0fVxyXG5cdCQkKHNlbCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuY29udGVudF9vYmoucXVlcnlTZWxlY3RvckFsbChzZWwpO1xyXG5cdH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQYW5lbDtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5jb25zdCBQYW5lbCA9IHJlcXVpcmUoJy4vcGFuZWwuanMnKTtcclxuXHJcbmNsYXNzIFByb21wdFBhbmVsIGV4dGVuZHMgUGFuZWwge1xyXG5cdGNvbnN0cnVjdG9yKHRpdGxlKSB7XHJcblx0XHRzdXBlcih7d2lkdGg6IDQwMCwgaGVpZ2h0OiAxMDAsIHRpdGxlfSk7XHJcblx0XHR0aGlzLmNvbnRlbnRfb2JqLmlubmVySFRNTCA9IGBcclxuPGlucHV0IHN0eWxlPSd3aWR0aDo5MCUnIHR5cGU9J3RleHQnIGNsYXNzPSdwcm9tcHQtdmFsdWUnPjwvaW5wdXQ+XHJcbjxpbnB1dCB0eXBlPSdidXR0b24nIGNsYXNzPSdjb25maXJtLWJ1dHRvbicgdmFsdWU9J09LJz5cclxuYDtcclxuXHRcdHRoaXMucmV0dXJuX3ZhbCA9IG51bGw7XHJcblx0XHR0aGlzLiQoJy5jb25maXJtLWJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMucmV0dXJuX3ZhbCA9IHRoaXMuJCgnLnByb21wdC12YWx1ZScpLnZhbHVlO1xyXG5cdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHR9KTtcclxuXHRcdHRoaXMuJCgnLnByb21wdC12YWx1ZScpLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcblx0XHRcdGlmKGUud2hpY2ggPT0gMTMpIHsgLy8gZW50ZXJcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0dGhpcy5yZXR1cm5fdmFsID0gdGhpcy4kKCcucHJvbXB0LXZhbHVlJykudmFsdWU7XHJcblx0XHRcdFx0dGhpcy5jbG9zZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHRoaXMuJCgnLnByb21wdC12YWx1ZScpLmZvY3VzKCk7XHJcblx0fVxyXG5cclxuXHRhc3luYyB2YWx1ZV9wcm9taXNlKCkge1xyXG5cdFx0YXdhaXQgdGhpcy53YWl0X3VudGlsX2Nsb3NlKCk7XHJcblx0XHRyZXR1cm4gdGhpcy5yZXR1cm5fdmFsO1xyXG5cdH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQcm9tcHRQYW5lbDtcclxuIl19"}